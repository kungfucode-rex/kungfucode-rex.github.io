<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>全局约定 | 小二后台文档</title>
    <meta name="description" content="小二租车后台相关文档整理">
    
    
    <link rel="preload" href="/assets/css/0.styles.2fff8c1e.css" as="style"><link rel="preload" href="/assets/js/app.c3744aec.js" as="script"><link rel="preload" href="/assets/js/15.a6221973.js" as="script"><link rel="prefetch" href="/assets/js/12.88664107.js"><link rel="prefetch" href="/assets/js/2.cda51ec0.js"><link rel="prefetch" href="/assets/js/3.af90b4ef.js"><link rel="prefetch" href="/assets/js/4.16d908f6.js"><link rel="prefetch" href="/assets/js/5.ce2ca426.js"><link rel="prefetch" href="/assets/js/6.d10e4f86.js"><link rel="prefetch" href="/assets/js/7.bed7386d.js"><link rel="prefetch" href="/assets/js/8.86359e27.js"><link rel="prefetch" href="/assets/js/9.b3a822d9.js"><link rel="prefetch" href="/assets/js/10.c7523b84.js"><link rel="prefetch" href="/assets/js/11.edfc6fd8.js"><link rel="prefetch" href="/assets/js/13.d9955fe2.js"><link rel="prefetch" href="/assets/js/14.a36ed5c8.js"><link rel="prefetch" href="/assets/js/16.b90b5373.js"><link rel="prefetch" href="/assets/js/17.c48a4604.js"><link rel="prefetch" href="/assets/js/18.48514253.js"><link rel="prefetch" href="/assets/js/19.fbdc757e.js"><link rel="prefetch" href="/assets/js/20.94a6ea97.js"><link rel="prefetch" href="/assets/js/21.cd234c79.js"><link rel="prefetch" href="/assets/js/22.3c53a600.js"><link rel="prefetch" href="/assets/js/23.71c2398d.js"><link rel="prefetch" href="/assets/js/24.585ab507.js"><link rel="prefetch" href="/assets/js/25.516afe77.js"><link rel="prefetch" href="/assets/js/26.2e52134a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2fff8c1e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小二后台文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/framework/" class="nav-link router-link-active">基础框架</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">插件</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/plugins/AsyncValidator.html" class="nav-link">Async-validator</a></li><li class="dropdown-item"><!----> <a href="/plugins/Axios.html" class="nav-link">Axios</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">业务后台</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/business/PanGu.html" class="nav-link">盘古后台</a></li><li class="dropdown-item"><!----> <a href="/business/BG.html" class="nav-link">BG后台</a></li><li class="dropdown-item"><!----> <a href="/business/Waibao.html" class="nav-link">外包后台</a></li><li class="dropdown-item"><!----> <a href="/business/NewEnergy.html" class="nav-link">新能源后台</a></li><li class="dropdown-item"><!----> <a href="/business/Ranyou.html" class="nav-link">燃油后台</a></li><li class="dropdown-item"><!----> <a href="/business/Weixin.html" class="nav-link">微信后台</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/framework/" class="nav-link router-link-active">基础框架</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">插件</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/plugins/AsyncValidator.html" class="nav-link">Async-validator</a></li><li class="dropdown-item"><!----> <a href="/plugins/Axios.html" class="nav-link">Axios</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">业务后台</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/business/PanGu.html" class="nav-link">盘古后台</a></li><li class="dropdown-item"><!----> <a href="/business/BG.html" class="nav-link">BG后台</a></li><li class="dropdown-item"><!----> <a href="/business/Waibao.html" class="nav-link">外包后台</a></li><li class="dropdown-item"><!----> <a href="/business/NewEnergy.html" class="nav-link">新能源后台</a></li><li class="dropdown-item"><!----> <a href="/business/Ranyou.html" class="nav-link">燃油后台</a></li><li class="dropdown-item"><!----> <a href="/business/Weixin.html" class="nav-link">微信后台</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/framework/" class="sidebar-link">小二租车新后台前端框架</a></li><li><a href="/framework/GlobalAppoint.html" class="active sidebar-link">全局约定</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/framework/GlobalConfig.html" class="sidebar-link">全局配置</a></li><li><a href="/framework/GlobalInstanceProps.html" class="sidebar-link">全局实例属性和方法</a></li><li><a href="/framework/GlobalUtils.html" class="sidebar-link">全局工具</a></li><li><a href="/framework/VersionAndOffline.html" class="sidebar-link">版本更新与离线访问</a></li><li><a href="/framework/MenuRouter.html" class="sidebar-link">菜单路由</a></li><li><a href="/framework/QueryListPage.html" class="sidebar-link">查询列表页面 QueryListPage</a></li><li><a href="/framework/FormPage.html" class="sidebar-link">表单提交页面 FormPage</a></li><li><a href="/framework/FormWidgets.html" class="sidebar-link">表单组件</a></li><li><a href="/framework/OtherWidgets.html" class="sidebar-link">其它组件</a></li><li><a href="/framework/ChangeLogs.html" class="sidebar-link">ChageLogs</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="全局约定"><a href="#全局约定" aria-hidden="true" class="header-anchor">#</a> 全局约定</h1> <h3 id="_1-默认新增成功、编辑成功后返回查询列表"><a href="#_1-默认新增成功、编辑成功后返回查询列表" aria-hidden="true" class="header-anchor">#</a> 1. 默认新增成功、编辑成功后返回查询列表</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 新增返回</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$load</span><span class="token punctuation">(</span><span class="token string">'listPageName'</span><span class="token punctuation">)</span>
<span class="token comment">// 修改,详情返回</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-查询时所有字段全都提交，不管是否为空"><a href="#_2-查询时所有字段全都提交，不管是否为空" aria-hidden="true" class="header-anchor">#</a> 2. 查询时所有字段全都提交，不管是否为空</h3> <h3 id="_3-同一模块内页面跳转使用this-load-pagename-params-，参考this-load"><a href="#_3-同一模块内页面跳转使用this-load-pagename-params-，参考this-load" aria-hidden="true" class="header-anchor">#</a> 3. 同一模块内页面跳转使用<code>this.$load(pageName[, params])</code>，参考<a href="/GlobalInstanceProps?id=load-pagename-params-">this.$load</a></h3> <h3 id="_4-调用登录用户信息使用this-loginuser"><a href="#_4-调用登录用户信息使用this-loginuser" aria-hidden="true" class="header-anchor">#</a> 4. 调用登录用户信息使用<code>this.$loginUser</code></h3> <h3 id="_5-列表操作列统一用框架封装的方法-this-getlistoperationbtns-h-params-btns-例"><a href="#_5-列表操作列统一用框架封装的方法-this-getlistoperationbtns-h-params-btns-例" aria-hidden="true" class="header-anchor">#</a> 5. 列表操作列统一用框架封装的方法 <code>this.$getListOperationBtns(h, params, [btns])</code>, 例:</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  title<span class="token punctuation">:</span> <span class="token string">'操作'</span><span class="token punctuation">,</span>
  key<span class="token punctuation">:</span> <span class="token string">'action'</span><span class="token punctuation">,</span>
  align<span class="token punctuation">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
  render<span class="token punctuation">:</span> <span class="token punctuation">(</span>h<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$getListOperationBtns</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> params<span class="token punctuation">,</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>label<span class="token punctuation">:</span> <span class="token string">'通过'</span><span class="token punctuation">,</span> handler<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>passHandler<span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>label<span class="token punctuation">:</span> <span class="token string">'不通过'</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span> handler<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>refuseHandler<span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  width<span class="token punctuation">:</span> <span class="token number">150</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-导出cvs文件-有两种方式："><a href="#_6-导出cvs文件-有两种方式：" aria-hidden="true" class="header-anchor">#</a> 6. 导出cvs文件, 有两种方式：</h3> <ol><li>用<code>this.$exportCSV(filename, json2csvOpts)</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>self<span class="token punctuation">.</span><span class="token function">$exportCSV</span><span class="token punctuation">(</span><span class="token string">'要到出的文件名'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> data<span class="token punctuation">,</span>
    fields<span class="token punctuation">:</span> fields<span class="token punctuation">,</span>
    fieldNames<span class="token punctuation">:</span> fieldNames<span class="token punctuation">,</span>
    quotes<span class="token punctuation">:</span> <span class="token string">''</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>用QueryListPage组件的<code>exportCsv()</code>方法导出，参考<a href="/framework/QueryListPage.html#exportcsv-导出查询数据">exportCsv()</a></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">[</span><span class="token string">'illegalQueryListPage'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">exportCsv</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  chunkSize：<span class="token number">1000</span>，<span class="token comment">//分批导出，每 1000 条记录发一次请求，之后会自动合并成一个文件</span>
  excelStrFields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'orderNo'</span><span class="token punctuation">,</span> <span class="token string">'phone'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 订单号和手机号要在excel里是字符串格式</span>
  dateStrFields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'createTime'</span><span class="token punctuation">,</span> <span class="token string">'payTime'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 创建时间和支付时间是毫秒数，导出为YYYY-MM-DD HH:mm:ss</span>
  sysCodeConf<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 支付方式字段payTool和状态字段status导出时要将value转为label</span>
    payTool<span class="token punctuation">:</span> <span class="token string">'PayTools'</span><span class="token punctuation">,</span>
    status<span class="token punctuation">:</span> <span class="token string">'IllegalStatus'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  callback<span class="token punctuation">:</span> item <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 备注字段是一个数组，每条记录的第０个备注对象里有个remark字段，将其导出</span>
    item<span class="token punctuation">.</span>remarks <span class="token operator">=</span> item<span class="token punctuation">.</span>remarks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>remarks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>remark
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_7-使用工具库qs时，应使用全局变量this-qs"><a href="#_7-使用工具库qs时，应使用全局变量this-qs" aria-hidden="true" class="header-anchor">#</a> 7. 使用工具库<code>qs</code>时，应使用全局变量<code>this.$qs</code></h3> <h3 id="_8-图片预览组件统一使用-album-list-options-height-album"><a href="#_8-图片预览组件统一使用-album-list-options-height-album" aria-hidden="true" class="header-anchor">#</a> 8. 图片预览组件统一使用<code>&lt;album :list=&quot;&quot; :options=&quot;&quot; height=&quot;&quot;&gt;&lt;/album&gt;</code></h3> <ul><li>参数：
<ul><li><code>{Array&lt;string&gt;} list</code>: 图片的url数组</li> <li><code>{Object} options</code>: <code>v-viewer</code>的配置属性（可选）</li> <li><code>{string} height</code>: 相册组件的高度（可选）</li></ul></li></ul> <h3 id="_9-路由全局拦截时请求自动添加-header-x-csrf-token"><a href="#_9-路由全局拦截时请求自动添加-header-x-csrf-token" aria-hidden="true" class="header-anchor">#</a> 9. 路由全局拦截时请求自动添加 <code>header['x-csrf-token']</code></h3> <h3 id="_10-路由全局拦截时请求自动添加参数operator，值为this-loginuser-name"><a href="#_10-路由全局拦截时请求自动添加参数operator，值为this-loginuser-name" aria-hidden="true" class="header-anchor">#</a> 10. 路由全局拦截时请求自动添加参数<code>operator</code>，值为<code>this.$loginUser.name</code></h3> <h3 id="_11-列表宽度必须为数字，而且必须有使用minwidth的一列，防止列表撑不满页面"><a href="#_11-列表宽度必须为数字，而且必须有使用minwidth的一列，防止列表撑不满页面" aria-hidden="true" class="header-anchor">#</a> 11. 列表宽度必须为数字，而且必须有使用<code>minWidth</code>的一列，防止列表撑不满页面</h3></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/framework/" class="prev router-link-active">
          小二租车新后台前端框架
        </a></span> <span class="next"><a href="/framework/GlobalConfig.html">
          全局配置
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/15.a6221973.js" defer></script><script src="/assets/js/app.c3744aec.js" defer></script>
  </body>
</html>
